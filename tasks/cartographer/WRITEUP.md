# Cartographer: Write-up

Даётся клон GeoGuessr -- игры, в которой по Street View (панорама, по которой можно ходить) надо
найти место, где эта панорама началась. Отличия в том, что в этом варианте нет системы очков, да и
панорамы тоже нет. Есть только картинка в абсурдно низком разрешении, input с плейсхолдером и
интерактивная карта.

Среди первых 124 картинок каждая всего лишь пятая указывает на какое-то легкое место. Можно
попытаться протыкать их руками, но достаточно быстро будут попадаться места, которые найти непросто
-- например, абстрактная дорога.

Нетрудно догадаться, что общение с сервером происходит через плюс-коды вместо передачи float-ов
широты и долготы. Можно заметить подключение внешнего скрипта OpenLocationCode и посмотреть, как
координаты с карты выставляются в поле ответа.

От одной маленькой картинки не очень много толку. Можно предположить по сложности "несложная"
заглянуть в её EXIF-метаданные и найти там геометку. Забираем её через любой онлайн-просмотрщик EXIF
и переводим её в плюс-код.

Ручной перевод немного муторный: открыть точку в гуглокартах, скопировать плюс-код с человеческим
городом, и переведём его в правильный через [карту плюс-кодов](https://plus.codes/map). Как раз для
ручного протыкивания и есть это ограничение в 100 метров.

Я вот первые примерно 30 картинок руками геотегала часов 10 и искала, откуда они сняты. Никому не
посоветую таким заниматься. Остальные картинки с фиксированной геометкой просто с OpenStreetCam
взялa и ещё часов пять угрохала за механическим "тыкнуть куда-нибудь > скопировать картинку >
скопировать локацию > определить плюс-код > сохранить > повторить". Очень надеюсь, что страшное 2024
в самом начале отпугнуло от ручного решения.

Через три-четыре картинки утомляемся ручной работой и пишем [простой скрипт на питоне](solve.py),
который выдирает геометку и переводит её в плюс-код и отправляет на сервер. Библиотеку для работы с
плюс-кодами можно взять оттуда же, откуда я взяла её для js-кода: с [гитхаб-репы с реализацией](
https://github.com/google/open-location-code/).

Дальше -- дело техники, можно чай попить, так как решение работает около десяти минут.

Можно заметить, что я немного ленивая, и картинки начинают повторяться. Вот только это не повод
закидывать один и тот же ответ -- так как после 124 раунда картинки генерятся по-умному: берется
случайная точка на суше, определяется её биом, и выбирается одна из 10 картинок для конкретного
биома. Со временем это занятие, конечно, немного наскучивает.

Флаг: **ugra_i_am_the_mr_worldwide_lbzvmcrl3nef**

# Postmortem

Оказывается, на 92-й картинке застряло несколько человек. Нужно было правильно обрабатывать
полушария, а то Белый Дом мог оказаться в Китае. Почему именно 92? Так видимо совпало что в хороших
полушариях оказалось столько картинок. Нужно смотреть не только на EXIF тег `latitude`/`longitude`,
но и ещё на соответствующие им `latitude_ref` и `longitude_ref`.

А я-то думала, что у меня в моём идеальном (нет) коде оказалась бага...
